"use strict";(self.webpackChunkmidonald=self.webpackChunkmidonald||[]).push([[403,649],{44403:function(at,re,r){r.r(re),r.d(re,{DivideAreaTitle:function(){return Ne},Download:function(){return Zt},DragTreeTable:function(){return Gt},DynamicTable:function(){return ut},LinkClick:function(){return vt},ListPage:function(){return qt},ListQueryForm:function(){return It},SearchInput:function(){return en},TagSelect:function(){return rn},UploadExcel:function(){return sn},downloadTemplate:function(){return Ge}});var xn=r(999),lt=r(57213),g=r.n(lt),Oe=r(94935),m=r(50959),t=r(11527),rt=function(e){var a=e.title,u=e.style,f=e.noLine,S=f===void 0?!1:f,s=e.subTitle,n=s===void 0?!1:s;return(0,t.jsxs)(t.Fragment,{children:[n?(0,t.jsxs)("div",{style:g()({position:"relative",height:32,marginBottom:16,paddingLeft:8,borderRadius:4,fontSize:14,lineHeight:"32px",fontWeight:"bold",color:"#222",backgroundColor:"#f6f6f6"},u),children:[(0,t.jsx)("div",{style:{position:"absolute",left:0,top:8,width:4,height:16,borderRadius:"5px 0px 5px 0px",backgroundColor:"#ffbc0d"}}),a]}):(0,t.jsx)("div",{style:g()({fontWeight:"bold",color:"#101010",fontSize:"16px"},u),children:a}),S?null:(0,t.jsx)(Oe.Z,{style:{margin:"16px 0",color:"#f1f1f1"}})]})},Ne=rt,ot=r(93525),oe=r.n(ot),it=r(54306),U=r.n(it),V=r(72002),M=r(40352),ie=r(43026),dt=function(e,a){var u=e.overMax,f=e.overMaxTxt,S=e.columns,s=e.addText,n=e.disabled,i=n===void 0?!1:n,h=e.addType,b=h===void 0?"long":h,C=e.tableOpt,P=C===void 0?{}:C,F=e.dataSource,j=F===void 0?[]:F,I=e.expandNode,w=I===void 0?null:I,D=e.onAdd,p=(0,m.useState)([]),L=U()(p,2),Z=L[0],O=L[1],x=(0,m.useState)(0),l=U()(x,2),d=l[0],N=l[1];(0,m.useEffect)(function(){O(j.map(function(y,c){return y.key=c,y})),N(j.length)},[j]);var k=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(u&&Z.length>=u){V.Z.warning("\u8D85\u51FA\u6700\u5927\u53EF\u521B\u5EFA\u6570\u91CF");return}O(function(v){return[].concat(oe()(v),[g()({key:d},c)])}),N(d+1)},T=function(c){O(function(v){return v.filter(function(A,E){return E!==c})})};(0,m.useImperativeHandle)(a,function(){return{getTableData:function(){return Z},handleAddRow:k,handleDeleteRow:T}});var R=function(){return k()};return(0,t.jsxs)(t.Fragment,{children:[b==="button"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.Z,{type:"primary",onClick:D||R,disabled:i,style:{marginBottom:16},children:s!=null?s:"+\u65B0\u589E"}),w]}):null,b==="link"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.Z,{type:"link",onClick:D||R,disabled:i,style:{marginBottom:16},children:s!=null?s:"+\u65B0\u589E"}),w]}):null,(0,t.jsx)(ie.Z,g()({columns:S,dataSource:Z,pagination:!1},P)),b==="long"?(0,t.jsx)(M.Z,{block:!0,type:"primary",disabled:i,onClick:D||R,style:{marginTop:16},children:s!=null?s:"+\u65B0\u589E"}):null]})},ut=m.forwardRef(dt),st=r(79226),yn=r(53649),ct=function(e){var a=e.type,u=a===void 0?"link":a,f=e.classList,S=f===void 0?"":f,s=e.popconfirmProps,n=e.children,i=e.onClick,h=function(C){typeof i=="function"&&i(C)};return(0,t.jsxs)(t.Fragment,{children:[u==="popConfirm"&&(0,t.jsx)(st.Z,g()(g()({placement:"leftBottom",title:"\u662F\u5426\u786E\u8BA4\u64CD\u4F5C\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onConfirm:h,getPopupContainer:function(){return document.body}},s),{},{children:(0,t.jsx)("span",{role:"link",tabIndex:0,className:"link-span-click ".concat(S),children:n!=null?n:"/"})})),u==="link"&&(0,t.jsx)("span",{role:"link",tabIndex:0,className:"link-span-click ".concat(S),onClick:h,children:n!=null?n:"/"})]})},vt=ct,ft=r(5013),pt=r(10213),de=r(99059),ke=r(96420),pe=r(44222),gt=r(29716),ge=r(22382),Ae=r(17373),mt=r(19639),ht=r(21911),xt=gt.Z.RangePicker,yt=ge.Z.TextArea,St=function(e){return(0,t.jsx)(ge.Z,g()({placeholder:"\u8BF7\u8F93\u5165",allowClear:!0},e))},Tt=function(e){return(0,t.jsx)(yt,g()({rows:1,allowClear:!0,placeholder:"\u8BF7\u8F93\u5165"},e))},bt=function(e){return(0,t.jsx)(Ae.Z,g()({allowClear:!0,style:{width:"100%"},getPopupContainer:function(u){return u.parentNode},placeholder:"\u8BF7\u9009\u62E9"},e))},Ct=function(e){return(0,t.jsx)(mt.Z,g()({placeholder:"\u8BF7\u9009\u62E9",getPopupContainer:function(u){return u.parentNode}},e))},Dt=function(e){return(0,t.jsx)(xt,g()({allowClear:!0},e))},jt=function(e){return(0,t.jsx)(ht.Z,g()({changeOnSelect:!0,showSearch:!0,expandTrigger:"hover",showCheckedStrategy:"SHOW_PARENT",placeholder:"\u8BF7\u9009\u62E9"},e))},ue={Input:St,TextArea:Tt,Select:bt,ProDictSelect:Ct,RangePicker:Dt,Cascader:jt},Ue=m.forwardRef(function(o,e){var a=o.className,u=a===void 0?"":a,f=o.style,S=o.queryBtnText,s=o.resetBtnText,n=o.showFilterText,i=o.hideFilterText,h=o.formItems,b=o.noHide,C=o.type,P=C===void 0?"query":C,F=o.onSearch,j=(0,m.useState)(!1),I=U()(j,2),w=I[0],D=I[1],p=(0,m.useRef)(null);(0,m.useImperativeHandle)(e,function(){return{formRef:p.current,getFormData:function(){var l;return((l=p.current)===null||l===void 0?void 0:l.getFieldsValue())||[]},getFormValue:function(l){var d;return(d=p.current)===null||d===void 0?void 0:d.getFieldValue(l)},restForm:function(){var l;return(l=p.current)===null||l===void 0?void 0:l.resetFields()},setFormValue:function(l,d){var N;return(N=p.current)===null||N===void 0?void 0:N.setFieldValue(l,d)},setFormValues:function(l){var d;return(d=p.current)===null||d===void 0?void 0:d.setFieldsValue(l)}}});var L=function(l){F&&F(l)},Z=function(){D(!w)},O=function(l){return l==null?void 0:l.map(function(d,N){var k,T,R,y,c;return d.type==="title"?(0,t.jsx)(de.Z,{span:12,children:(0,t.jsx)(Ne,{title:d.title,subTitle:!0,noLine:!0})},N):(0,t.jsx)(de.Z,{span:(k=d.span)!==null&&k!==void 0?k:3,children:d.type==="slot"?((T=d.render)===null||T===void 0?void 0:T.call(d))||((R=ue[d.component])===null||R===void 0?void 0:R.call(ue,d.componentProps)):(0,t.jsx)(ke.Z.Item,g()(g()({labelCol:{span:6},label:d.label,name:d.name},d.props),{},{children:((y=d.render)===null||y===void 0?void 0:y.call(d))||((c=ue[d.component])===null||c===void 0?void 0:c.call(ue,d.componentProps))}))},N)})};return(0,t.jsxs)(ke.Z,{ref:p,name:"basic",className:"midonald-search-form ".concat(u),style:f,onFinish:L,size:"middle",layout:"vertical",children:[P==="query"&&(0,t.jsx)("div",{className:"midonald-search-area",children:(0,t.jsxs)(pe.Z,{gutter:32,children:[O(h.showItems),w&&!b?O(h.hideItems):null,(0,t.jsxs)(de.Z,{span:12,children:[(0,t.jsx)(M.Z,{type:"primary",htmlType:"submit",children:S!=null?S:"\u67E5\u8BE2"}),(0,t.jsx)(M.Z,{onClick:function(){var l;(l=p.current)===null||l===void 0||l.resetFields()},children:s!=null?s:"\u91CD\u7F6E"}),!b&&(0,t.jsxs)(M.Z,{type:"link",size:"small",onClick:Z,children:[w?"".concat(i!=null?i:"\u9690\u85CF\u67E5\u8BE2\u6761\u4EF6"):"".concat(n!=null?n:"\u5168\u90E8\u67E5\u8BE2\u6761\u4EF6"),w?(0,t.jsx)(ft.Z,{}):(0,t.jsx)(pt.Z,{})]})]})]})}),P==="other"&&(0,t.jsx)(pe.Z,{gutter:32,children:O(h.showItems)})]})}),It=Ue,wt=r(25359),se=r.n(wt),Ft=r(49811),Ee=r.n(Ft),Rt=r(12342),ce=r.n(Rt),J=r(60776),me=r(70218),Pt=["success","failure","requestParams","baseUrl","btnText","btnSize","disabled","downloadType"],Lt=function(e){var a=e.success,u=e.failure,f=e.requestParams,S=e.baseUrl,s=S===void 0?"":S,n=e.btnText,i=n===void 0?"\u4E0B\u8F7D":n,h=e.btnSize,b=h===void 0?"small":h,C=e.disabled,P=C===void 0?!1:C,F=e.downloadType,j=F===void 0?"label":F,I=ce()(e,Pt),w=function(){var p=Ee()(se()().mark(function L(){return se()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(s){O.next=3;break}return V.Z.warn("\u6CA1\u6709\u4E0B\u8F7D\u5730\u5740"),O.abrupt("return");case 3:me.Z.get(s,g()(g()({},f),{},{headers:g()({"Cache-Control":"no-cache","McD-Page-Route":window.location.pathname,Authorization:(0,J.LP)()},f==null?void 0:f.headers),responseType:"blob"})).then(function(x){if(typeof a=="function"){a(x);return}var l=x.data;if(Object.prototype.toString.call(l||{})==="[object Blob]"){var d=new FileReader;d.readAsDataURL(l),d.onload=function(){var k,T,R,y,c,v=document.createElement("a"),A=(k=x.headers["content-disposition"])===null||k===void 0||(T=k.match)===null||T===void 0||(R=T.call(k,/(filename=(.*))/))===null||R===void 0?void 0:R[2];if(!A)if((l==null?void 0:l.type)==="application/vnd.ms-excel")A="\u6A21\u677F.xlsx";else{V.Z.warning("\u6587\u4EF6\u540D\u4E0D\u5B58\u5728");return}v.download=decodeURI((y=A)===null||y===void 0||(c=y.replace)===null||c===void 0?void 0:c.call(y,/^"|"$/g,"")),v.href=d==null?void 0:d.result,v.click(),v.remove()}}else if(parseInt(l==null?void 0:l.code)!==2e3&&(l==null?void 0:l.code)!=="SUCCESS"){var N;V.Z===null||V.Z===void 0||V.Z.error((N=l==null?void 0:l.msg)!==null&&N!==void 0?N:l==null?void 0:l.message)}}).catch(function(x){var l;if(typeof u=="function"){u(x);return}V.Z===null||V.Z===void 0||V.Z.error((l=x==null?void 0:x.msg)!==null&&l!==void 0?l:x==null?void 0:x.message)});case 4:case"end":return O.stop()}},L)}));return function(){return p.apply(this,arguments)}}(),D=g()(g()({},I),{},{size:b,disabled:!s||P,onClick:j==="label"?void 0:w});return(0,t.jsx)(t.Fragment,{children:["label","blob"].includes(j)?(0,t.jsx)(M.Z,g()(g()({},D),{},{children:j==="label"?(0,t.jsx)("a",{download:"",href:"".concat(s,"?authorization=").concat(J.LP===null||J.LP===void 0?void 0:(0,J.LP)()),children:i}):i})):null})},Zt=(0,m.memo)(Lt),Ot=r(52510),ae=r.n(Ot),Nt=r(85899),ze=r.n(Nt),kt=r(60464),At=r(4690),Be="DraggableBodyRow",Sn={didDrop:"didDrop",hover:"hover",drop:"drop"},Tn={group:"group",child:"child"},Ut=function(e,a,u,f,S){var s,n,i,h,b,C,P=function F(j){for(var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,w=0;w<j.length;w++){var D=j[w];D[a]===u&&(s=D,i=w,b=I),D[a]===f&&(n=D,h=w,C=I);var p=D[S]||[];(p==null?void 0:p.length)>0&&F(p,D)}return{dragRow:s,dropRow:n,dragIndex:i,dropIndex:h,dragParent:b,dropParent:C}};return P(e)},Et=r(32475),zt=r(94033),Bt=r(98314),Kt=r(18625),Vt=function(e){var a=(0,Kt.f)(function(n){return{item:n.getItem(),itemType:n.getItemType(),initialOffset:n.getInitialSourceClientOffset(),currentOffset:n.getSourceClientOffset(),isDragging:n.isDragging()}}),u=a.isDragging,f=a.initialOffset,S=a.currentOffset;if(!u)return null;function s(n,i){if(!n||!i)return{display:"none"};var h=i.x,b=i.y,C="translate(".concat(h,"px, ").concat(b,"px)");return{display:"table-row",position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%",transform:C}}return(0,t.jsx)("tr",{style:s(f,S),children:e.children})},Mt=Vt,Ht=["record","index","className","style","moveRow","idKey","parentKey","canDrag","childrenDrag","parentValue","showPreview"],Qt=(0,m.memo)(function(o){var e;if(!o.moveRow)return(0,t.jsx)("tr",{});var a=o.record,u=o.index,f=o.className,S=o.style,s=o.moveRow,n=o.idKey,i=o.parentKey,h=o.canDrag,b=o.childrenDrag,C=o.parentValue,P=o.showPreview,F=ce()(o,Ht);if(!a)return null;var j=(e={},ae()(e,n,a==null?void 0:a[n]),ae()(e,"parentId",a==null?void 0:a[i]),ae()(e,"index",u),e),I=(0,m.useRef)(null),w=(0,Et.L)({accept:Be,collect:function(y){var c=y.getItem()||{},v=c[n],A=c.parentId,E=c.index;if(v===a[n])return{};var $=y.isOver();return A!=a[i]&&($=!1),{isOver:$,dropClassName:E<u?" drop-over-downward":" drop-over-upward",handlerId:y.getHandlerId()}},drop:function(y){if(Z){var c={dragId:y[n],dropId:a[n]};s(c)}}}),D=U()(w,2),p=D[0],L=p.handlerId,Z=p.isOver,O=p.dropClassName,x=D[1],l=(0,zt.c)({type:Be,item:j,collect:function(y){return{isDragging:y.isDragging()}},canDrag:function(){return j.parentId&&j.parentId!=C&&!b?!1:h}}),d=U()(l,3),N=d[0].isDragging,k=d[1],T=d[2];return(0,m.useEffect)(function(){x(k(I.current)),T((0,Bt.r)(),{captureDraggingState:!0})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("tr",g()({ref:I,className:"".concat(f).concat(Z?O:""),style:g()({},S),"data-handler-id":L},F)),N&&P&&(0,t.jsx)(Mt,{children:F.children})]})}),Wt=function(e){var a=(0,m.useState)(e.tableData||[]),u=U()(a,2),f=u[0],S=u[1],s={body:f.length>0?{row:Qt}:{}},n=e.idKey||"id",i=e.parentKey||"parentId",h=e.childrenKey||"children",b=e.parentValue||null,C=e.canDrag!==void 0?e.canDrag:!0,P=e.childrenDrag!==void 0?e.childrenDrag:!0;(0,m.useEffect)(function(){S(e.tableData)},[e.tableData]);var F=(0,m.useCallback)(function(j){var I=j.dragId,w=j.dropId,D=Ut(f,n,I,w,h),p=D.dragRow,L=D.dropRow,Z=D.dragIndex,O=D.dropIndex,x=D.dragParent,l=!p||!p[i]||p[i]===b,d;if(l)d=ze()(f,{$splice:[[Z,1],[O,0,p]]}),e.changeSort({data:d,dragRow:p,dropRow:L});else if(p&&L&&p[i]===L[i]&&P){d=ze()(x,ae()({},h,{$splice:[[Z,1],[O,0,p]]}));var N=function T(R,y){return R.map(function(c){if(c[n]===y[n])return d;var v=c[h]||[];return v.length>0?g()(g()({},c),{},ae()({},h,T(v,y))):c})},k=N(f,x);e.changeSort({data:k,dragRow:p,dropRow:L,afterParent:d})}},[f]);return(0,t.jsx)("div",{className:"drag-tree-table",children:(0,t.jsx)(kt.W,{backend:At.PD,children:(0,t.jsx)(ie.Z,g()(g()({},e.tableOptions),{},{dataSource:f,components:s,pagination:!1,childrenColumnName:h,onRow:function(I,w){var D={record:I,index:w,idKey:n,parentKey:i,childrenDrag:P,parentValue:b,canDrag:C,showPreview:e.showPreview,moveRow:F};return D}}))})})},Gt=Wt,Ke=r(2223);function Ve(o){var e,a=(0,Ke.Jt)(Ke.gT.PARAMETERS);if(a){var u=a.find(function(f){return f.parameterKey===o});e=u&&u.parameterValue}return e}function Jt(){return Ve("portal.pagesize")>0?Ve("portal.pagesize"):50}var Me=r(86438),Xt=["dataKeys","totalKeys","getDataApi","callback","formatParamsFn","listQueryFormOptions","tableOptions"];function He(o,e){return e.reduce(function(a,u){return a&&a[u]?a[u]:void 0},o)}var $e=1,Qe=Jt(),Yt=(0,m.forwardRef)(function(o,e){var a,u,f=o.dataKeys,S=o.totalKeys,s=o.getDataApi,n=o.callback,i=o.formatParamsFn,h=o.listQueryFormOptions,b=o.tableOptions,C=b===void 0?{}:b,P=ce()(o,Xt),F=(0,m.useState)(!1),j=U()(F,2),I=j[0],w=j[1],D=(0,m.useState)([]),p=U()(D,2),L=p[0],Z=p[1],O=(0,m.useState)(0),x=U()(O,2),l=x[0],d=x[1],N=(0,m.useState)($e),k=U()(N,2),T=k[0],R=k[1],y=(0,m.useState)(Qe),c=U()(y,2),v=c[0],A=c[1],E=(0,m.useRef)(null),$=(0,Me.$)(),B=$.t,X=function(K){var Q=K;i&&(Q=i(K)),s&&(w(!0),s(g()({pageNum:T,pageSize:v},Q)).then(function(te){Z(He(te,f)),S&&d(He(te,S)),n==null||n(te)}).finally(function(){w(!1)}))};(0,m.useEffect)(function(){X({pageNum:T,pageSize:v})},[]);var ve=function(K){R(1),X(g()({pageNum:1},K))},fe=function(){var K=E.current.getFormData();X(g()({pageNum:T,pageSize:v},K))},ee=function(K,Q){R(K!=null?K:$e),A(Q!=null?Q:Qe),fe()};return(0,m.useImperativeHandle)(e,function(){return{handlePageChange:ee,refreshList:fe}}),(0,t.jsxs)("div",{className:"pcm-table-container",children:[(0,t.jsx)(Ue,g()({ref:E,onSearch:ve},h)),(0,t.jsxs)("div",{className:"pcm-table-top-wrap",children:[((a=C==null||(u=C.allFilterColumns)===null||u===void 0?void 0:u.length)!==null&&a!==void 0?a:0)>0?(0,t.jsx)("div",{className:"pcm-table-absolute-buttons",children:P.children}):P.children,(0,t.jsx)(ie.Z,g()({dataSource:L,pagination:{total:l,current:T,pageSizeOptions:["10","20","50","100"],showSizeChanger:!0,showTotal:function(K){return"".concat(B("product_msg_inTotal")," ").concat(K," ").concat(B("product_make_a_record"))}},loading:I,scroll:{x:"100%"},onChange:function(K){return ee(K.current,K.pageSize)}},C))]})]})}),qt=Yt,_t=function(e){var a=e.btnText,u=a===void 0?"\u67E5\u8BE2":a,f=e.inputStyle,S=e.onSearch,s=(0,m.useState)(""),n=U()(s,2),i=n[0],h=n[1],b=function(){S(i)},C=function(F){F.keyCode===13&&b()};return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,t.jsx)(ge.Z,{style:g()({marginRight:15},f),allowClear:!0,onKeyUp:C,onChange:function(F){return h(F.target.value)},placeholder:"\u8BF7\u8F93\u5165"}),(0,t.jsx)(M.Z,{type:"primary",htmlType:"submit",onClick:b,children:u})]})},en=_t,tn=r(54689),nn=r.n(tn),he=r(10422),an=["value","newLabelTip","options","getData","setTagValue","placeholder","notFoundContent"],ln=function(e){var a,u=e.value,f=e.newLabelTip,S=f===void 0?"\u65B0\u6807\u7B7E":f,s=e.options,n=s===void 0?[]:s,i=e.getData,h=i===void 0?function(){return[]}:i,b=e.setTagValue,C=b===void 0?function(){}:b,P=e.placeholder,F=P===void 0?"\u6761\u4EF6tag":P,j=e.notFoundContent,I=j===void 0?"\u65E0\u5339\u914D\u6807\u7B7E":j,w=ce()(e,an),D=(0,m.useState)(""),p=U()(D,2),L=p[0],Z=p[1],O=(0,m.useState)(!1),x=U()(O,2),l=x[0],d=x[1],N=(0,m.useState)([]),k=U()(N,2),T=k[0],R=k[1],y=(0,m.useMemo)(function(){return Ee()(se()().mark(function c(){var v;return se()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(Array.isArray(n)&&n!==null&&n!==void 0&&n.length)){E.next=3;break}return R(oe()(n)),E.abrupt("return");case 3:typeof h=="function"&&R((v=h())!==null&&v!==void 0?v:[]);case 4:case"end":return E.stop()}},c)}))},[]);return(0,m.useEffect)(function(){y()},[y]),(0,t.jsx)(Ae.Z,g()({allowClear:!0,showSearch:!0,open:l,style:{width:"30%"},value:u,placeholder:F,onInputKeyDown:function(v){var A=v.target.value;v.keyCode===13&&A&&L&&(0,he.unstable_batchedUpdates)(function(){C(A),Z(""),d(!1)})},onSearch:function(v){if(!v||v===u){Z("");return}if(!(T!=null&&T.length)){Z(v);return}var A=!1,E=nn()(T),$;try{for(E.s();!($=E.n()).done;){var B=$.value;if(v===B){A=!0;break}}}catch(X){E.e(X)}finally{E.f()}Z(A?"":v)},onChange:function(v){C(v),Z("")},notFoundContent:!L&&!(T!=null&&T.length)?null:I,dropdownRender:function(v){return(0,t.jsxs)(t.Fragment,{children:[v,L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Oe.Z,{style:{margin:"8px 0"}}),(0,t.jsx)("div",{style:{width:"100%",padding:"0 8px 4px"},role:"link",onClick:function(){(0,he.unstable_batchedUpdates)(function(){C(L),Z(""),d(!1)})},children:"".concat(L,"(").concat(S,")")})]}):null]})},options:T==null||(a=T.map)===null||a===void 0?void 0:a.call(T,function(c){var v,A;return{label:(v=c==null?void 0:c.label)!==null&&v!==void 0?v:c,value:(A=c==null?void 0:c.value)!==null&&A!==void 0?A:c}}),onDropdownVisibleChange:function(v){(0,he.unstable_batchedUpdates)(function(){Z(""),d(v)})},getPopupContainer:function(v){return v.parentElement}},w))},rn=ln,on=r(9769),We=r(49294),dn=r(26024),Ge=function(e){me.Z.post(e,{},{responseType:"blob",headers:{Authorization:(0,J.LP)(),"Content-Type":"application/json","Cache-Control":"no-cache"}}).then(function(a){if(a.data==0){var u;V.Z.warning((u=$t("product_lbl_cannot_exported"))!==null&&u!==void 0?u:"\u6570\u636E\u4E3A\u7A7A\uFF0C\u4E0D\u80FD\u5BFC\u51FA")}else{var f=new Blob([a.data],{type:"application/vnd.ms-excel"}),S=a.headers["content-disposition"],s=S?S.match(/(filename=(.*))/):null,n=s&&s[2]?decodeURI(s[2]):"default.xls";if("download"in document.createElement("a")){var i=document.createElement("a");i.download=n,i.style.display="none",i.href=URL.createObjectURL(f),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}else navigator.msSaveBlob&&navigator.msSaveBlob(f,n)}})},un=function(e){var a=e.btnText,u=e.okText,f=e.closeText,S=e.modalTitle,s=e.errModalTit,n=e.supportTypeTxt,i=e.templateTxt,h=e.fileBtnTxt,b=e.modelType,C=b===void 0?"pcm":b,P=e.errorContent,F=e.templateMethod,j=e.templateURL,I=e.errListField,w=e.uploadURL,D=e.btnType,p=D===void 0?"default":D,L=e.paramField,Z=e.frontSlot,O=e.endSlot,x=e.width,l=x===void 0?373:x,d=e.className,N=e.errTableOpt,k=e.errColumns,T=e.errType,R=T===void 0?"tips":T,y=e.onSuccess,c=e.onIllegal,v=e.onError,A=e.fileSize,E=A===void 0?100:A,$=(0,Me.$)(),B=$.t,X=(0,m.useState)(!1),ve=U()(X,2),fe=ve[0],ee=ve[1],Y=(0,m.useState)(!1),K=U()(Y,2),Q=K[0],te=K[1],cn=(0,m.useState)([]),Je=U()(cn,2),W=Je[0],q=Je[1],vn=(0,m.useState)([]),Xe=U()(vn,2),Ye=Xe[0],ne=Xe[1],fn=(0,m.useState)(!1),qe=U()(fn,2),_e=qe[0],le=qe[1],pn=(0,m.useState)(!1),et=U()(pn,2),gn=et[0],tt=et[1],xe=function(){te(!1),q([]),ne([]),le(!1)},nt=function(){tt(!1),q([]),ne([]),le(!1)},mn={onRemove:function(H){var G=W.indexOf(H),z=W.slice();z.splice(G,1),q(z)},beforeUpload:function(H){if(!(H.size/1024/1024<E)){var G;V.Z.warning("".concat((G=B("product_msg_select_file_Cannot_More_Than"))!==null&&G!==void 0?G:"\u6587\u4EF6\u4E0D\u80FD\u8D85\u8FC7").concat(E,"M"));return}if(H.name.split(".").pop()!=="xls"&&H.name.split(".").pop()!=="xlsx")return V.Z.warning(n!=null?n:B("product_lbl_file_format_xlsx_xls")),!1;if(W.length===0)q([].concat(oe()(W),[H])),ne([]),le(!1);else{var z;V.Z.warning((z=B("product_lbl_one_file_uploaded"))!==null&&z!==void 0?z:"\u53EA\u80FD\u4E0A\u4F20\u4E00\u4E2A\u6587\u4EF6"),q(oe()(W)),ne([]),le(!1)}return!1}},hn=function(){if(Ye.length&&ne([]),W.length===0){var H;V.Z.warning((H=B("product_lbl_select_file_imported"))!==null&&H!==void 0?H:"\u8BF7\u9009\u62E9\u5BFC\u5165\u6587\u4EF6");return}var G=new FormData;W.forEach(function(z){G.append(L||"files",z)}),ee(!0),me.Z.post(w,G,{headers:{Authorization:(0,J.LP)()}}).then(function(z){if(q([]),ee(!1),z.data.code==="SUCCESS"){var ye,Se,Te,be,Ce;if(I&&((ye=z.data)===null||ye===void 0||(Se=ye.data)===null||Se===void 0||(Te=Se[I])===null||Te===void 0?void 0:Te.length)>0||!I&&((be=z.data)===null||be===void 0||(Ce=be.data)===null||Ce===void 0?void 0:Ce.length)>0){var De,je,Ie,we,Fe;if(console.log("response.data.data",(De=z.data)===null||De===void 0||(je=De.data)===null||je===void 0?void 0:je.length),R==="modal"){var Re,Pe,Le;tt(!0),ne(I?(Re=z.data)===null||Re===void 0||(Pe=Re.data)===null||Pe===void 0?void 0:Pe[I]:(Le=z.data)===null||Le===void 0?void 0:Le.data)}else le(!0);c==null||c(I?(Ie=z.data)===null||Ie===void 0||(we=Ie.data)===null||we===void 0?void 0:we[I]:(Fe=z.data)===null||Fe===void 0?void 0:Fe.data)}else{if(y)y(z.data);else{var Ze;V.Z.success((Ze=B("product_msg_import_Success"))!==null&&Ze!==void 0?Ze:"\u5BFC\u5165\u6210\u529F")}xe()}}else v==null||v(z.data.msg)}).catch(function(){q([]),ee(!1)})};return(0,t.jsxs)("div",{style:{display:"inline-block"},children:[(0,t.jsx)(M.Z,{size:"middle",type:p,onClick:function(){te(!0)},children:a}),(0,t.jsxs)(We.Z,{width:l,className:"midonald-import-modal "+d,destroyOnClose:!0,maskClosable:!1,title:S,onCancel:xe,open:Q,footer:[(0,t.jsx)(M.Z,{type:"primary",loading:fe,onClick:function(){return hn()},children:u!=null?u:B("product_btn_import")},"submit"),(0,t.jsx)(M.Z,{onClick:xe,children:f!=null?f:B("product_btn_close")},"back")],children:[Z,C==="pcm"?(0,t.jsxs)("p",{className:"upload-tips-info-new",children:[(0,t.jsx)("span",{className:"upload-format",children:n!=null?n:B("product_lbl_file_format_xlsx_xls")}),j&&F==="POST"&&(0,t.jsx)("a",{onClick:function(){Ge(j)},children:i!=null?i:B("product_lbl_downloadtemplate")}),j&&F!=="POST"&&(0,t.jsx)("a",{href:"".concat(j,"?token=").concat((0,J.LP)()),children:i!=null?i:B("product_lbl_downloadtemplate")})]}):null,(0,t.jsx)(dn.Z,g()(g()({className:"upload-key-package-row required-tip",style:{marginBottom:_e?"8px":"20px"}},mn),{},{fileList:W,accept:".xls, .xlsx",children:(0,t.jsx)(M.Z,{icon:(0,t.jsx)(on.Z,{}),children:h!=null?h:B("product_lbl_select_file")})})),O,_e?(0,t.jsx)("div",{className:"illega-tips-style-box",children:(0,t.jsx)(pe.Z,{children:(0,t.jsx)(de.Z,{span:12,children:(0,t.jsx)("ul",{className:"illega-tips-style",children:P})})})}):""]}),(0,t.jsx)(We.Z,{width:700,zIndex:1002,destroyOnClose:!0,maskClosable:!1,title:s!=null?s:B("cp_import_failed"),open:gn,onCancel:nt,footer:[(0,t.jsx)(M.Z,{style:{marginTop:"36px"},onClick:nt,children:f!=null?f:B("product_btn_close")},"back")],className:"import-modal",children:(0,t.jsx)(ie.Z,g()({dataSource:Ye,columns:k,pagination:!1},N))})]})},sn=un},53649:function(at,re,r){r.r(re)}}]);
